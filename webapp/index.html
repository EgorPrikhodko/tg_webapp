<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Магазин одежды</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <!-- Скрипт Telegram WebApp -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <main class="container">
    <h1>Магазин одежды</h1>

    <section class="card">
      <h2>Футболка «Basic»</h2>
      <p>100% хлопок, размеры S–XL</p>
      <label>Размер:
        <select id="size">
          <option>S</option><option>M</option><option>L</option><option>XL</option>
        </select>
      </label>
      <label>Количество:
        <input id="qty" type="number" min="1" value="1" />
      </label>
      <button id="buy">Оформить заказ</button>
    </section>
  </main>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand(); // раскрыть WebApp на весь экран
    tg.MainButton.setParams({ text: "Отправить заказ", is_visible: false });

    const buyBtn = document.getElementById('buy');
    const sizeEl = document.getElementById('size');
    const qtyEl  = document.getElementById('qty');

    buyBtn.addEventListener('click', () => {
      const order = {
        item: "Футболка Basic",
        size: sizeEl.value,
        qty: Number(qtyEl.value),
        user: tg.initDataUnsafe?.user || null
      };
      // показываем главную кнопку Telegram
      tg.MainButton.show();
      tg.MainButton.onClick(() => {
        tg.sendData(JSON.stringify(order)); // улетит боту в handle_webapp_data
        tg.close();
      });
    });
  </script>
</body>
</html>
